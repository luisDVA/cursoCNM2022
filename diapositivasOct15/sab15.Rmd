---
title: "Introducci√≥n a R mediante la visualizaci√≥n de datos"
subtitle: "D√≠a 1"  
author: 
  - "Luis D. Verde Arregoitia"
date: 'CNM Octubre 2022'
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    self_contained: true
    nature:
      slideNumberFormat: "%current%"
      highlightStyle: github
      highlightLines: true
      ratio: 16:9
      countIncrementalSlides: true
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(
  fig.width=9, fig.height=3.5, fig.retina=3,
  out.width = "100%",
  cache = FALSE,
  echo = TRUE,
  message = FALSE, 
  warning = FALSE,
  hiline = TRUE
)
library(fontawesome)
```

```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer)
style_duo_accent(
  primary_color = "#202c56",
  secondary_color = "#ac965a",
  inverse_header_color = "#FFFFFF",
  inverse_background_color = "#ac965a",
  base_font_size = "25px",
  text_font_size=  "1.45rem",
  link_decoration = "underline dotted red",
  code_font_size = "1.25rem",
  code_inline_color= "#003049",
  code_inline_background_color = "#FFFCFE",
  blockquote_left_border_color = "#003049"
  )

```

```{r xaringan-tachyons, echo=FALSE}
library(xaringanExtra)
xaringanExtra::use_tachyons()
```

```{r xaringan-animate-all, echo=FALSE, eval=TRUE}
xaringanExtra::use_animate_all("fade")
```

```{r xaringan-extra-styles, eval=TRUE, echo=FALSE}
xaringanExtra::use_extra_styles(
  hover_code_line = TRUE,     
)
```

```{r xaringan-scribble, echo=FALSE}
xaringanExtra::use_scribble()
```

```{r xaringan-editable, echo=FALSE}
xaringanExtra::use_editable(expires = 1)
```

```{r xaringanExtra-clipboard, echo=FALSE}
xaringanExtra::use_clipboard()
```

```{r html output, eval=TRUE, include=FALSE}
options(htmltools.dir.version = FALSE, htmltools.preserve.raw = FALSE)
```

```{css, echo = F}
.dk-section-title {
box-shadow: inset 0 0 0 1000px rgba(0,0,0,0.5);
}

.dk-section-title h1 {
  color: #f3f3f3;
  font-size: 100px;
  line-height: 1;
}

.smallcode .remark-code { /*Change made here*/
  font-size: 75% !important;
}

```


## Introducci√≥n

R como entorno y lenguaje de programaci√≥n  

Objetos, funciones y paquetes

## Flujos de trabajo y an√°lisis
Organizaci√≥n de proyectos  

Estructura y organizaci√≥n de datos


---

## Visualizaci√≥n de datos

Introducci√≥n a `ggplot2`  

Representaciones gr√°ficas de informaci√≥n  

Preparaci√≥n de figuras cient√≠ficas  


---

.center[
<img src="imgs/rake.jpg" width = 40% /> 
]
---

## ¬øQu√© es `r fa(name = "r-project")`?

.can-edit[‚úçÔ∏èSoftware]

--

¬øDialecto de S? 
¬øPaquete estad√≠stico? 
¬øRStudio? 
¬øLenguage de programaci√≥n? 
¬øDispositivo gr√°fico?

---

## ¬øQui√©nes usan `r fa(name = "r-project")`?

- Bi√≥logos
- SAT
- Ministerio de Econom√≠a Argentino
- MS, Meta, Google, AT&T
- Equipos deportivos
- Etc.

https://bookdown.org/jboscomendoza/r-principiantes4/quien-usa-r.html

---

## `r fa(name = "r-project")`?

.pull-left[
.can-edit[‚úçÔ∏èüßë‚ÄçüéìVentajas]
]

.pull-left[
.can-edit[‚úçÔ∏èüßë‚ÄçüéìDesventajas]
]

---

## Software libre y gratuito

.pull-left[
"_free_"

Gratis != Libre

]

<img src="imgs/morrito.png" width = 20% />  

> The whole R engine is open source so, if you wish, you can check
every line of it. If people were out to push dodgy software, this is not the way they‚Äôd go about it.

.tr[
Bill Venables, 2004
]

---

### Software libre y acceso al c√≥digo fuente

.b[Libertad de:] 
    
.f4[
- Ejecutar el programa como se desee, con cualquier prop√≥sito.
- Estudiar c√≥mo funciona el programa, y cambiarlo para que haga lo que se desee 
  
- Redistribuir copias para ayudar a otros
- Redistribuir copias de sus versiones modificadas para que la comunidad aproveche las modificaciones
]  

.tr[
[Open Software Foundation -General Public License](https://www.gnu.org/philosophy/essays-and-articles.html#principles)
]

---

# `r fa(name = "r-project")` no es `r fa(name = "registered")`studio

**IDE** - Entorno de desarrollo integrado

Herramientas para facilitar el uso de un lenguaje de programaci√≥n
- Editor de texto que 'reconoce' la sintaxis de un lenguage  

- Atajos y herramientas para administrar y ejecutar c√≥digo

---

<img src="https://spss-tutorials.com/img/spss-data-editor-data-view.png" />  

.tr.f4[
Ruben Geert van den Berg  
https://www.spss-tutorials.com
]

---

## Scripts y c√≥digo fuente

.pull-left[
<img src="imgs/pancks.png"/ width= 70% >  
]

Reproducir y modificar pasos  

Encontrar errores  

Documentar el proceso

Examinar c√≥digo ajeno

---

# Principios de programaci√≥n en R

.f2[
Todo lo que existe es un _objeto_  

Todo lo que ocurre lo hace una **funci√≥n**  
   (_Las funciones son objetos_)

Las **funciones** (generalmente) viven en paquetes
]
---

## Objetos

- Tablas con filas y columnas

- Modelos

- Listas

- Gr√°ficos

Todos los objetos tienen clases y atributos y hay distintas formas de crearlos

---

# üì¶ Paquetes

Al instalar R instalamos: 

`base`:  las funciones m√°s fundamentales de R

.can-edit[
‚úçÔ∏èüßë‚Äçüéì  
`list()`  
`log()`  
`cat()`
]


---

## Funciones

.code.f1[nombre.red[(]argumentos.red[)]]

.code.f1[promediar.red[(]20,12.red[)]]

Llamamos funciones por su nombre y entre par√©ntesis van los argumentos (con qu√© objeto trabajar y c√≥mo)

---

### üì¶ Paquetes

.pull-left[
Otros componentes de R-base:  
.f4[
`utils, stats, datasets, graphics, grDevices, grid, methods, tools, parallel, compiler, splines, tcltk, stats4`
]
]

.pull-right[
Paquetes 'recomendados' (se instalan con R pero no se cargan autom√°ticamente)  

.f4[`boot, class, cluster, codetools, foreign, KernSmooth, lattice, mgcv, nlme, rpart, survival, MASS, spatial, nnet, Matrix`]
]

---

### üì¶ Paquetes Adicionales

- m√°s de 18,400 en [CRAN](https://cran.r-project.org/) (The Comprehensive R Archive Network) 

- muchos m√°s en GitHub, GitLab, Bitbucket, Bioconductor, etc.


Se instalan desde R con:  

`install.packages()` para paquetes de CRAN  
`üì¶ remotes` para todos los dem√°s repositorios

---

class: inverse

# Visita guiada por R y RStudio

- Ejecutar R 

- Ejecutar RStudio

- Instalar paquetes para hoy:

```{r, eval=FALSE}
install.packages("ggplot2")
install.packages("dplyr")
install.packages("openintro")
install.packages("gt")
install.packages("fs")
```

---
class: inverse, center, middle


# Antes de aprender sobre objetos y funciones:

---


# Sistemas de archivos

.fl.w-third[
<img src="imgs/filenotfound.png" width="80%"/>  

.small[
Monica Chin (2021)  
[File not Found](https://www.theverge.com/22684730/students-file-folder-directory-structure-education-gen-z)
]
]

.fl.w-third[
<img src="imgs/filesfolders.png" width="80%"/>  
.small[
Jody Macgregor (2021)  
[PC Gamer](https://www.pcgamer.com/students-dont-know-what-files-and-folders-are-professors-say/)
]
]

.fl.w-third[
<img src="imgs/fsmeme.png" width="60%"/>  
]

---
background-image: url(imgs/escritorioadri.png)
background-size: contain

---

## Directorios, rutas y nombres

.fl.w-third[
<img src="imgs/file-system.jpg" width="70%"/>  
.f5[Fuente: The Network Encyclopedia]
]

Guardar archivos en ubicaciones espec√≠ficas, con nombres intencionales y √∫tiles

- Nombres cortos e informativos


- Nombres que se puedan ordenar y que cooperen con b√∫squedas parciales

---

### Nombres

.fl.w-40[
### OK  
`max_temp`
</br>  
</br>
`prec_min_usd`  
`temp_mensual`  
]

.fl.w-60[
### No tanto  
`temperatura_maximaC20102014`  
`max`  
`temp`  
`'Precio M√≠nimo ($) USD'`  
`'Temperatura/Mes (¬∞F)'`  
</br>
]
.tr[
Jenny Bryan (2015)  
[Naming Things](https://speakerdeck.com/jennybc/how-to-name-files)
]

---

### Organizaci√≥n de proyectos

.b[proyecto]: un directorio en su m√°quina que contiene todo los archivos relevantes para alg√∫n trabajo en particular

.f3[Separar:]

.f3[
 üìÅ Datos .f4[(o c√≥digo para cargarlos de fuentes remotas)]  
 üìÅ _Scripts_ de an√°lisis y/o visualizaci√≥n  
 üìÅ Salidas (figuras, informes, datos intermedios, etc.)
]

.pull-left[
Jenny Bryan (2017)  
[Project-oriented workflow](https://www.tidyverse.org/blog/2017/12/workflow-vs-script/)]

.pull-right[
Ma√´lle Salmon (2021)  
[Draw me a project](https://masalmon.eu/2021/06/30/r-projects/)
]

---

<img src="imgs/rprojects.png" width="46%" align="right"/>  

.b.f3.blue[Proyectos en RStudio]

- Instancia de R dedicada  

- Navegador apuntando al directorio del proyecto
  - bot√≥n para regresar al dir. del proyecto

- Dir. de proyecto establecido como Dir. de Trabajo
  - rutas relativas al Dir. de Proyecto

---

class: inverse

## Ejercicio

.f2[
Crear un proyecto para el curso en RStudio
- en alguna ubicaci√≥n f√°cil de encontrar (ej. Escritorio)
- "cursoCNM-R" como nombre
]
---

## üì¶ {`fs`}

Trabajando con el sistema de archivos (cualquier plataforma)

`fs` siempre trabaja con rutas ordenadas 

  -  '**`/`**' para delimitar carpetas  
  - Sin  '**`/`**' dobles o extras

.left-column[
Algunas funciones:
]

Crear directorios  
Mover archivos  
Copiar archivos  
Cambiar nombres  

---

class: inverse

# Ejercicio

- Crear nuevas carpetas en el directorio del proyecto  
  - datos
  - salida
  - R

### Los paquetes ya instalados se cargan con la funci√≥n `library()`
```{r, eval=FALSE}
library(fs)
```

---

class: inverse

## Crear nuevas carpetas en el directorio del proyecto  

```{r, eval=FALSE}
dir_create("R")
dir_create("datos")
dir_create("salida")
dir_ls()
```

> Todo esto tambi√©n se puede hacer desde el navegador de RStudio o el explorador del sistema operativo
---

### Guardar la fuente y no el entorno

.left-column[
<img src="imgs/pancks.png"/>  
]

.right-column[
- Exportar figuras y resultados a archivos

- Evitar `rm(list = ls())`. 
- 'Hoja en blanco' & reiniciar R seguido
]

.tr[
.f4[
Jenny Bryan & Jim Hester (2020)  
[What they forgot to teach you about R](https://rstats.wtf/save-source.html)  
Jenny Bryan (2018)    
[Zen And The aRt Of Workflow Maintenance](https://speakerdeck.com/jennybc/zen-and-the-art-of-workflow-maintenance)
]]

---

<img src="imgs/clnslt.jpg" width="50%" align="right"/>  

.f3.b.blue[Hoja en blanco (blank slate)]  

No se guarda el espacio de trabajo a un archivo .Rdata

No se carga el espacio de trabajo desde un archivo .Rdata al arrancar R

.f3.b.blue[Reiniciar R ]
 
Ctrl+Shift+F10  
 (Windows \ Linux)  
 
Command+Shift+F10 (Mac)

---

## üì¶ .black[{here}] y rutas relativas

.f5[`F:\mi macbook\ruta\que\solo\tengo\mi-proyecto\analisis\script1.R`]

Trabajemos en relaci√≥n a la ra√≠z del proyecto con la funci√≥n `here()`

- resuelve cu√°l es la ra√≠z del proyecto
- construye rutas port√°tiles
- genera rutas absolutas (comienzan con `/`, `C:\` o `\\`)

.tr[
[Ode to the here package (2018)](https://github.com/jennybc/here_here)
]

---

class: middle
La ra√≠z del proyecto es `mi-proyecto`

```{r, eval=FALSE}
here("analisis","script1.R")
```
contruye:  
  
.f5[`F:\mi macbook\ruta\que\solo\tengo\mi-proyecto\analisis\script1.R`]

---

.b[`here()`] no cambia el directorio de trabajo, solo construye rutas

.b[`here()`] resuelve cu√°l es la ra√≠z de un proyecto (i.e. d√≥nde est√° el archivo `.Rproj`?) y las rutas son relativas a √©sto

http://jenrichmond.rbind.io/post/how-to-use-the-here-package/



---
class: dk-section-title
background-image:url("imgs/brigalow.jpg")
background-size: cover


# .white[Objetos]

---

.pull-left[
.f2.green[Vectores]  
<img src="imgs/vector.png" width=56%/>  

.f2.green[Listas]

<img src="imgs/listhad.png" width=96%/>  
]


.pull-right[
.f2.green[Tablas]

<img src="imgs/dataframe.png" width=60%/>  

]

---

## Vectores

N√∫meros
```{r}
c(1,2,3,4)
```

```{r}
c(22.1,0.006,4.1)
```

---

## Vectores

Caracteres

```{r}
c("perro","gato","rata","B")
```

---

## Vectores

L√≥gicos (verdadero/falso)

```{r}
c(TRUE,FALSE,FALSE,FALSE,TRUE)
```

---
.center[
<img src="imgs/logical.jpg" />  
]
---
.center[
<img src="imgs/logicalNA.jpg" />  
]
---

# Creando objetos

```{r}
x <- c(1, 2, 3)
```

Funci√≥n `c()` sirve para combinar valores en un vector

### ¬øQu√© pas√≥ aqu√≠?

---

# Operadores de asignaci√≥n

.center[
.f1.code[<-]

.f1.code[=]
]

```{r}
x <- c(1, 2, 3)
```

---
```{r}
x <- c(1, 2, 3)
```

- Se cre√≥ un objeto (vector num√©rico con los valores 1,2,3)
- Se 'vincul√≥' el objeto con un **nombre**, `x`

.center[
..."crear un objeto "x" con los n√∫meros 1,2,3"...
]
<img src="imgs/binding-1.png" />  

.tr[
https://adv-r.hadley.nz/names-values.html
]
---

```{r}
x <- c(1,2,3)
y <- c("a","G","h")
```

```{r}
x
y
```

---

## Los objetos tienen clases

```{r}
class(x)
class(y)
```

---

## Los vectores solo pueden tener objetos de la misma clase

```{r}
c(1,"a",2)
```

Al combinar caracteres y n√∫meros hay conversi√≥n autom√°tica

---
## Vectores num√©ricos
<img src="imgs/numeric.jpg" />  

---
## Factores

.pull-left[
<img src="imgs/factor.jpg" width=86%/>  
]

Representan datos categ√≥ricos

Las etiquetas de cada valor se conocen como niveles, que pueden o no llevar un orden espec√≠fico

Crear con `factor()`

---

### Factores

```{r}
factor(c("perro","gato","ave","ninguno",
         "perro","ninguno","perro","perro",
         "gato","ave","perro"))
```

---

## Dos o m√°s vectores del mismo largo...

--
.pull-left[
<img src="imgs/dataframe.jpg" width=80% />  
]

### Data frame!

Objeto tabular con filas y columnas

Puede almacenar objetos de distintas clases en las columnas

Nombres para cada columna

---

## Data frames

Crear al importar un archivo tabular o con `data.frame()`

```{r}
mi_tabla <- 
data.frame(id=c("rana","pez","nutria","gusano"),
           ind_g=c(12,15,13,10),
           listo=c(TRUE,TRUE,FALSE,TRUE))

```

- cada vector es una columna
- nombres de columnas sin comillas
- mismo largo p/ todos los vectores

---
```{r}
mi_tabla
```

---

## Importando archivos (tablas)

- Con el bot√≥n "_Import Dataset_"
- Con alguna funci√≥n `read`

.can-edit[
‚úçÔ∏èüßë‚Äçüéì   
read.tsv()  
read.csv()

]

---
class: inverse

# Ejercicio

Importar una tabla a R desde un archivo:

- 2 hojas de calculo
- 2 csv

Si necesitan inspiraci√≥n:
https://vincentarelbundock.github.io/Rdatasets/

---

# `readr` y `readlx`

Paquetes adicionales para importar datos rectangulares desde archivos de texto y hojas de c√°lculo

- Menos errores al importar

- Mayor flexibilidad al leer archivos

- Lectura m√°s r√°pida 

- Funciones adicionales para limpiar los valores en las columnas

---

class: dk-section-title
background-image:url("imgs/brigalow.jpg")
background-size: cover


# .white[`ggplot2`]
